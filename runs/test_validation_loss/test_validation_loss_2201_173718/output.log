2025-01-22 17:37:18,284: Logging to runs\test_validation_loss\test_validation_loss_2201_173718\output.log initialized.
2025-01-22 17:37:18,285: ### Folder structure created at runs\test_validation_loss\test_validation_loss_2201_173718
2025-01-22 17:37:18,285: ### Run configurations for test_validation_loss
2025-01-22 17:37:18,285: autoregressive_inputs: ['Flow_m3_sec_zscore_norm_shift18']
2025-01-22 17:37:18,285: batch_size: 512
2025-01-22 17:37:18,286: clip_gradient_norm: 1
2025-01-22 17:37:18,286: clip_targets_to_zero: ['Flow_m3_sec_zscore_norm']
2025-01-22 17:37:18,286: data_dir: ..\data\Caravan_for_Omri_N
2025-01-22 17:37:18,286: dataset: caravan
2025-01-22 17:37:18,286: device: cpu
2025-01-22 17:37:18,286: dynamic_inputs: ['Rain_gauge_1_zscore_norm', 'Rain_gauge_2_zscore_norm', 'Rain_gauge_3_zscore_norm']
2025-01-22 17:37:18,296: epochs: 5
2025-01-22 17:37:18,296: experiment_name: test_validation_loss
2025-01-22 17:37:18,296: forcings: ['il']
2025-01-22 17:37:18,296: head: regression
2025-01-22 17:37:18,296: hidden_size: 64
2025-01-22 17:37:18,297: initial_forget_bias: 3
2025-01-22 17:37:18,297: lagged_features: {'Flow_m3_sec_zscore_norm': [18], 'Rain_gauge_1_zscore_norm': [18], 'Rain_gauge_2_zscore_norm': [18], 'Rain_gauge_3_zscore_norm': [18]}
2025-01-22 17:37:18,297: learning_rate: 0.001
2025-01-22 17:37:18,297: log_interval: 1
2025-01-22 17:37:18,297: log_n_figures: 8
2025-01-22 17:37:18,297: log_tensorboard: True
2025-01-22 17:37:18,298: loss: MSE
2025-01-22 17:37:18,298: metrics: ['MSE']
2025-01-22 17:37:18,298: model: arlstm
2025-01-22 17:37:18,298: num_workers: 0
2025-01-22 17:37:18,298: optimizer: Adam
2025-01-22 17:37:18,298: output_activation: linear
2025-01-22 17:37:18,299: output_dropout: 0
2025-01-22 17:37:18,299: predict_last_n: 1
2025-01-22 17:37:18,299: save_weights_every: 1
2025-01-22 17:37:18,299: seq_length: 36
2025-01-22 17:37:18,299: target_variables: ['Flow_m3_sec_zscore_norm']
2025-01-22 17:37:18,299: use_basin_id_encoding: False
2025-01-22 17:37:18,300: test_basin_file: RT_flood\test_basins.txt
2025-01-22 17:37:18,300: test_end_date: 2018-05-30 00:00:00
2025-01-22 17:37:18,300: test_start_date: 2017-10-01 00:00:00
2025-01-22 17:37:18,300: train_basin_file: RT_flood\test_basins.txt
2025-01-22 17:37:18,300: train_start_date: [Timestamp('2010-10-01 00:00:00')]
2025-01-22 17:37:18,301: train_end_date: [Timestamp('2011-05-30 00:00:00')]
2025-01-22 17:37:18,301: validate_every: 1
2025-01-22 17:37:18,301: validate_n_random_basins: 0
2025-01-22 17:37:18,301: validation_basin_file: RT_flood\test_basins.txt
2025-01-22 17:37:18,301: validation_start_date: 2015-10-01 00:00:00
2025-01-22 17:37:18,301: validation_end_date: 2016-05-30 00:00:00
2025-01-22 17:37:18,302: run_dir: runs\test_validation_loss\test_validation_loss_2201_173718
2025-01-22 17:37:18,302: number_of_basins: 1
2025-01-22 17:37:18,302: train_dir: runs\test_validation_loss\test_validation_loss_2201_173718\train_data
2025-01-22 17:37:18,302: img_log_dir: runs\test_validation_loss\test_validation_loss_2201_173718\img_log
2025-01-22 17:37:18,304: ### Device cpu will be used for training
2025-01-22 17:37:18,308: Loading basin data into xarray data set.
2025-01-22 17:37:18,775: Create lookup table and convert to pytorch tensor
2025-01-22 17:37:21,759: Validation set to validate every 1 epoch(s), but 'validate_n_random_basins' not set or set to zero. Will validate on the entire validation set.
2025-01-22 17:37:24,984: Epoch 0 average validation loss: 1.39359 -- Median validation metrics: avg_loss: 1.39359, MSE: 0.60290
2025-01-22 17:37:29,710: Epoch 1 average loss: avg_loss: 0.39212, avg_total_loss: 0.39212
2025-01-22 17:37:31,943: Epoch 1 average validation loss: 1.15551 -- Median validation metrics: avg_loss: 1.15551, MSE: 0.51135
2025-01-22 17:37:36,556: Epoch 2 average loss: avg_loss: 0.24781, avg_total_loss: 0.24781
2025-01-22 17:37:38,763: Epoch 2 average validation loss: 1.01463 -- Median validation metrics: avg_loss: 1.01463, MSE: 0.45152
2025-01-22 17:37:43,529: Epoch 3 average loss: avg_loss: 0.16661, avg_total_loss: 0.16661
2025-01-22 17:37:45,783: Epoch 3 average validation loss: 0.92761 -- Median validation metrics: avg_loss: 0.92761, MSE: 0.41453
2025-01-22 17:37:50,469: Epoch 4 average loss: avg_loss: 0.11960, avg_total_loss: 0.11960
2025-01-22 17:37:52,731: Epoch 4 average validation loss: 0.84252 -- Median validation metrics: avg_loss: 0.84252, MSE: 0.37830
2025-01-22 17:37:57,587: Epoch 5 average loss: avg_loss: 0.08816, avg_total_loss: 0.08816
2025-01-22 17:37:59,811: Epoch 5 average validation loss: 0.83367 -- Median validation metrics: avg_loss: 0.83367, MSE: 0.37457
