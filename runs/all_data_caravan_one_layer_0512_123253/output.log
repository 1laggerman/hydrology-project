2024-12-05 12:32:53,045: Logging to C:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\runs\all_data_caravan_one_layer_0512_123253\output.log initialized.
2024-12-05 12:32:53,045: ### Folder structure created at C:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\runs\all_data_caravan_one_layer_0512_123253
2024-12-05 12:32:53,045: ### Run configurations for all_data_caravan_one_layer
2024-12-05 12:32:53,046: experiment_name: all_data_caravan_one_layer
2024-12-05 12:32:53,046: run_dir: C:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\runs\all_data_caravan_one_layer_0512_123253
2024-12-05 12:32:53,046: train_basin_file: caravan_all_basins.txt
2024-12-05 12:32:53,046: validation_basin_file: caravan_all_basins.txt
2024-12-05 12:32:53,046: test_basin_file: caravan_all_basins.txt
2024-12-05 12:32:53,047: train_start_date: 2018-01-01 00:00:00
2024-12-05 12:32:53,047: train_end_date: 2020-12-31 00:00:00
2024-12-05 12:32:53,047: validation_start_date: 1989-01-01 00:00:00
2024-12-05 12:32:53,047: validation_end_date: 1990-12-31 00:00:00
2024-12-05 12:32:53,048: test_start_date: 1999-01-01 00:00:00
2024-12-05 12:32:53,048: test_end_date: 2000-12-31 00:00:00
2024-12-05 12:32:53,048: seed: None
2024-12-05 12:32:53,048: device: cuda:0
2024-12-05 12:32:53,048: validate_every: 1
2024-12-05 12:32:53,048: validate_n_random_basins: 6375
2024-12-05 12:32:53,049: metrics: ['NSE', 'KGE', 'FHV']
2024-12-05 12:32:53,049: model: cudalstm
2024-12-05 12:32:53,049: head: regression
2024-12-05 12:32:53,049: hidden_size: 256
2024-12-05 12:32:53,049: initial_forget_bias: 3
2024-12-05 12:32:53,049: output_dropout: 0.4
2024-12-05 12:32:53,050: output_activation: linear
2024-12-05 12:32:53,050: optimizer: Adam
2024-12-05 12:32:53,050: loss: NSE
2024-12-05 12:32:53,050: allow_subsequent_nan_losses: 100
2024-12-05 12:32:53,050: learning_rate: {0: 5e-05, 30: 5e-06}
2024-12-05 12:32:53,051: batch_size: 256
2024-12-05 12:32:53,051: epochs: 40
2024-12-05 12:32:53,051: clip_gradient_norm: None
2024-12-05 12:32:53,051: predict_last_n: 1
2024-12-05 12:32:53,051: seq_length: 365
2024-12-05 12:32:53,051: num_workers: 4
2024-12-05 12:32:53,052: log_interval: 5
2024-12-05 12:32:53,052: log_tensorboard: True
2024-12-05 12:32:53,052: save_weights_every: 1
2024-12-05 12:32:53,052: save_validation_results: False
2024-12-05 12:32:53,052: dataset: caravan
2024-12-05 12:32:53,052: data_dir: ..\..\data\Caravan
2024-12-05 12:32:53,053: forcings: ['maurer']
2024-12-05 12:32:53,053: dynamic_inputs: ['snow_depth_water_equivalent_mean', 'surface_net_solar_radiation_mean', 'surface_net_thermal_radiation_mean', 'surface_pressure_mean', 'temperature_2m_mean', 'dewpoint_temperature_2m_mean', 'u_component_of_wind_10m_mean', 'v_component_of_wind_10m_mean', 'volumetric_soil_water_layer_1_mean', 'volumetric_soil_water_layer_2_mean', 'volumetric_soil_water_layer_3_mean', 'volumetric_soil_water_layer_4_mean', 'total_precipitation_sum', 'potential_evaporation_sum']
2024-12-05 12:32:53,053: target_variables: ['streamflow']
2024-12-05 12:32:53,053: static_attributes: ['p_mean', 'pet_mean', 'aridity', 'frac_snow', 'high_prec_freq', 'high_prec_dur', 'low_prec_freq', 'low_prec_dur', 'moisture_index', 'seasonality', 'gwt_cm_sav', 'ele_mt_sav', 'slp_dg_sav', 'sgr_dk_sav', 'area', 'glc_pc_s01', 'glc_pc_s02', 'glc_pc_s03', 'glc_pc_s04', 'glc_pc_s06', 'glc_pc_s07', 'glc_pc_s08', 'glc_pc_s09', 'glc_pc_s10', 'glc_pc_s11', 'glc_pc_s12', 'glc_pc_s13', 'glc_pc_s14', 'glc_pc_s15', 'glc_pc_s16', 'glc_pc_s17', 'glc_pc_s18', 'glc_pc_s19', 'glc_pc_s20', 'glc_pc_s21', 'glc_pc_s22', 'pnv_pc_s01', 'pnv_pc_s02', 'pnv_pc_s03', 'pnv_pc_s04', 'pnv_pc_s05', 'pnv_pc_s06', 'pnv_pc_s07', 'pnv_pc_s08', 'pnv_pc_s09', 'pnv_pc_s10', 'pnv_pc_s11', 'pnv_pc_s12', 'pnv_pc_s13', 'pnv_pc_s14', 'pnv_pc_s15']
2024-12-05 12:32:53,054: statics_embedding: {'hiddens': 10}
2024-12-05 12:32:53,054: number_of_basins: 6375
2024-12-05 12:32:53,054: train_dir: C:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\runs\all_data_caravan_one_layer_0512_123253\train_data
2024-12-05 12:32:53,054: img_log_dir: C:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\runs\all_data_caravan_one_layer_0512_123253\img_log
2024-12-05 12:32:53,058: ### Device cuda:0 will be used for training
2024-12-05 12:32:53,067: Uncaught exception
Traceback (most recent call last):
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\test.py", line 22, in <module>
    start_run(Path('configs/LSTM.yml'), gpu=0)
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\nh_run.py", line 76, in start_run
    start_training(config)
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\training\train.py", line 19, in start_training
    trainer.initialize_training()
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\training\basetrainer.py", line 147, in initialize_training
    ds = self._get_dataset()
         ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\training\basetrainer.py", line 80, in _get_dataset
    return get_dataset(cfg=self.cfg, period="train", is_train=True, scaler=self._scaler)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\__init__.py", line 83, in get_dataset
    ds = Dataset(cfg=cfg,
         ^^^^^^^^^^^^^^^^
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\caravan.py", line 56, in __init__
    super(Caravan, self).__init__(cfg=cfg,
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\basedataset.py", line 146, in __init__
    self._load_data()
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\basedataset.py", line 718, in _load_data
    self._load_combined_attributes()
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\basedataset.py", line 666, in _load_combined_attributes
    df = self._load_attributes()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\caravan.py", line 70, in _load_attributes
    return load_caravan_attributes(data_dir=self.cfg.data_dir, basins=self.basins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\omrin\OneDrive\Desktop\Work\hydrology research\for work\hydrology-project\nhWrap\neuralhydrology\neuralhydrology\datasetzoo\caravan.py", line 126, in load_caravan_attributes
    raise FileNotFoundError(f"Could not find subdataset directories for {missing_subdatasets}.")
FileNotFoundError: Could not find subdataset directories for ['hysets', 'camelsbr', 'camelsgb', 'lamah', 'camels', 'camelsaus', 'camelscl'].
